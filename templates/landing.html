{% extends "base.html" %}

{% block title %}IL9Cast - Illinois 9th District Forecast{% endblock %}

{% block content %}
<section class="hero-section">
    <div class="hero-content">
        <h1 class="hero-title glitch" data-text="IL9CAST">IL9CAST</h1>
        <p class="hero-subtitle">2026 Democratic Primary Forecast</p>
        <p class="hero-description">Real-time predictions for Illinois's 9th Congressional District.</p>

        <div class="cta-group">
            <a href="/odds" class="cta-button primary">View Forecast</a>
            <a href="/methodology" class="cta-button secondary">How It Works</a>
        </div>
    </div>
</section>

<section class="featured-section">
    <div class="section-header">
        <h2>Current Forecast</h2>
        <p class="section-subtitle">Live odds and probabilities</p>
    </div>

    <div class="candidate-preview" id="candidatePreview">
        <div class="loading">Loading forecast data...</div>
    </div>
</section>

<section class="cta-section">
    <div class="cta-content">
        <h2>Ready to explore the model?</h2>
        <a href="/odds" class="cta-button primary large">Start Exploring</a>
    </div>
</section>

<script>
async function loadFeatured() {
    try {
        const response = await fetch('/api/forecast');
        const data = await response.json();

        const sorted = [...data.candidates].sort((a, b) => b.probability - a.probability);
        const top3 = sorted.slice(0, 3);

        const preview = document.getElementById('candidatePreview');
        preview.innerHTML = `
            <div class="candidates-grid">
                ${top3.map((candidate, idx) => `
                    <div class="candidate-card" style="animation-delay: ${idx * 0.1}s">
                        <div class="candidate-rank">#${idx + 1}</div>
                        <h3>${candidate.name}</h3>
                        <p class="role">${candidate.party_role}</p>
                        <div class="odds-display">
                            <span class="odds-number">${candidate.probability}%</span>
                            <span class="odds-label">Win Probability</span>
                        </div>
                    </div>
                `).join('')}
            </div>
        `;
    } catch (error) {
        console.error('Error:', error);
        document.getElementById('candidatePreview').innerHTML = '';
    }
}

document.addEventListener('DOMContentLoaded', loadFeatured);
</script>
{% endblock %}
