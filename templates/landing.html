{% extends "base.html" %}

{% block title %}IL9Cast - Illinois 9th District Forecast{% endblock %}

{% block content %}
<script>
// Hide navbar and footer on landing page
document.addEventListener('DOMContentLoaded', () => {
    document.querySelector('.navbar').style.display = 'none';
    document.querySelector('.footer').style.display = 'none';
    document.querySelector('.main-content').style.padding = '0';
});
</script>

<div class="desktop-container">
    <div class="branding-corner">IL9<span class="cast-italic">Cast</span></div>

    <!-- The Model Window -->
    <div class="window draggable-window" id="modelWindow" style="left: 100px; top: 100px;">
        <div class="window-header">
            <span class="window-icon">üìä</span>
            <span class="window-title">The Model</span>
            <div class="window-buttons">
                <button class="window-btn minimize-btn" onclick="minimizeWindow('modelWindow')">_</button>
                <button class="window-btn maximize-btn" onclick="maximizeWindow('modelWindow')">‚ñ°</button>
                <button class="window-btn close-btn" onclick="closeWindow('modelWindow')">‚úï</button>
            </div>
        </div>
        <div class="window-content">
            <p class="icon-large">üìä</p>
            <p class="window-label">The Model</p>
            <button class="open-btn" onclick="location.href='/odds'">Open</button>
        </div>
    </div>

    <!-- Methodology Window -->
    <div class="window draggable-window" id="methodWindow" style="left: 450px; top: 150px;">
        <div class="window-header">
            <span class="window-icon">üìñ</span>
            <span class="window-title">Methodology</span>
            <div class="window-buttons">
                <button class="window-btn minimize-btn" onclick="minimizeWindow('methodWindow')">_</button>
                <button class="window-btn maximize-btn" onclick="maximizeWindow('methodWindow')">‚ñ°</button>
                <button class="window-btn close-btn" onclick="closeWindow('methodWindow')">‚úï</button>
            </div>
        </div>
        <div class="window-content">
            <p class="icon-large">üìñ</p>
            <p class="window-label">Methodology</p>
            <button class="open-btn" onclick="location.href='/methodology'">Open</button>
        </div>
    </div>

    <!-- About Window -->
    <div class="window draggable-window" id="aboutWindow" style="left: 280px; top: 300px;">
        <div class="window-header">
            <span class="window-icon">‚ÑπÔ∏è</span>
            <span class="window-title">About</span>
            <div class="window-buttons">
                <button class="window-btn minimize-btn" onclick="minimizeWindow('aboutWindow')">_</button>
                <button class="window-btn maximize-btn" onclick="maximizeWindow('aboutWindow')">‚ñ°</button>
                <button class="window-btn close-btn" onclick="closeWindow('aboutWindow')">‚úï</button>
            </div>
        </div>
        <div class="window-content">
            <p class="icon-large">‚ÑπÔ∏è</p>
            <p class="window-label">About IL9Cast</p>
            <p class="about-text">Illinois 9th District Democratic Primary Forecast</p>
            <p class="about-text" style="font-size: 0.8rem; margin-top: 0.5rem;">Created by Ryan McComb</p>
        </div>
    </div>
</div>

<script>
let draggedElement = null;
let offsetX = 0;
let offsetY = 0;

// Make windows draggable
document.querySelectorAll('.draggable-window').forEach(win => {
    const header = win.querySelector('.window-header');

    header.addEventListener('mousedown', (e) => {
        draggedElement = win;
        offsetX = e.clientX - win.offsetLeft;
        offsetY = e.clientY - win.offsetTop;
        win.style.zIndex = getMaxZIndex() + 1;
    });
});

document.addEventListener('mousemove', (e) => {
    if (draggedElement) {
        draggedElement.style.left = (e.clientX - offsetX) + 'px';
        draggedElement.style.top = (e.clientY - offsetY) + 'px';
    }
});

document.addEventListener('mouseup', () => {
    draggedElement = null;
});

// Resize functionality
document.querySelectorAll('.window').forEach(win => {
    const resizeHandle = document.createElement('div');
    resizeHandle.className = 'resize-handle';
    win.appendChild(resizeHandle);

    resizeHandle.addEventListener('mousedown', (e) => {
        e.preventDefault();
        const startX = e.clientX;
        const startY = e.clientY;
        const startWidth = win.offsetWidth;
        const startHeight = win.offsetHeight;

        const moveResize = (e) => {
            win.style.width = (startWidth + e.clientX - startX) + 'px';
            win.style.height = (startHeight + e.clientY - startY) + 'px';
        };

        const stopResize = () => {
            document.removeEventListener('mousemove', moveResize);
            document.removeEventListener('mouseup', stopResize);
        };

        document.addEventListener('mousemove', moveResize);
        document.addEventListener('mouseup', stopResize);
    });
});

function minimizeWindow(id) {
    const win = document.getElementById(id);
    win.style.display = 'none';
}

function maximizeWindow(id) {
    const win = document.getElementById(id);
    if (win.style.width !== '90vw') {
        win.style.width = '90vw';
        win.style.height = '90vh';
        win.style.left = '5vw';
        win.style.top = '5vh';
    } else {
        win.style.width = '300px';
        win.style.height = 'auto';
    }
}

function closeWindow(id) {
    const win = document.getElementById(id);
    win.style.display = 'none';
}

function getMaxZIndex() {
    return Math.max(
        ...Array.from(document.querySelectorAll('.window')).map(el =>
            parseInt(window.getComputedStyle(el).zIndex) || 0
        )
    );
}
</script>
{% endblock %}
