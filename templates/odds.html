{% extends "base.html" %}

{% block title %}The Model - IL9Cast{% endblock %}

{% block content %}
<div class="model-page-wrapper">
    <div class="horizontal-rows" id="horizontalRows"></div>

    <nav class="inner-nav">
        <a href="/" class="back-link">IL9Cast</a>
        <div class="inner-nav-links">
            <a href="/odds" class="active">The Model</a>
            <a href="/markets">Markets</a>
            <a href="/fundraising">Fundraising</a>
            <a href="/methodology">Methodology</a>
            <a href="/about">About</a>
        </div>
    </nav>

    <div class="inner-content model-content">
        <h1 class="inner-title">The Model</h1>
        <p class="model-statement">Because this district is like...super...super uncompetitive and boring, it's really hard to find data to build a model, but i'm working on it.</p>

        <!-- Methodology Section -->
        <section class="methodology-section" style="max-width: 900px; margin: 3rem auto; text-align: left;">
            <div class="methodology-header" onclick="toggleMethodology()">
                <h2 style="margin: 0; font-family: 'Cormorant Garamond', Georgia, serif; font-size: 2rem;">Methodology</h2>
                <span class="toggle-icon" id="methodologyToggle">▼</span>
            </div>
            <div class="methodology-content hidden" id="methodologyContent">
                <div class="methodology-explanation">
                    <h3>The Challenge of Modeling IL-9</h3>
                    <p>
                        Building a statistical forecasting model for the Illinois 9th District Democratic Primary presents unique challenges. Unlike highly competitive general elections, this race lacks the robust polling infrastructure and historical precedents that traditional models rely on.
                    </p>

                    <h3>Data Availability Issues</h3>
                    <ul>
                        <li>No public district-level polling data available for the primary</li>
                        <li>Limited historical data on similar open-seat Democratic primaries in this district</li>
                        <li>Sparse demographic turnout models for primary elections vs. general elections</li>
                        <li>Candidate-specific metrics (endorsements, fundraising) updated infrequently</li>
                    </ul>

                    <h3>Model Development in Progress</h3>
                    <p>
                        The forecasting model is currently under development. Potential data sources being evaluated include:
                    </p>
                    <ul>
                        <li>FEC fundraising reports (total raised, cash on hand, donor counts, burn rate)</li>
                        <li>Endorsement scores weighted by endorser influence and district relevance</li>
                        <li>Social media engagement metrics as proxies for grassroots support</li>
                        <li>Prior electoral performance in overlapping districts (where applicable)</li>
                        <li>Prediction market probabilities as an input signal (with appropriate weighting)</li>
                    </ul>

                    <h3>Why This Is Difficult</h3>
                    <p>
                        Traditional political forecasting models (like FiveThirtyEight's election models) combine polls, fundamentals, and historical trends. For IL-9, we lack the first two:
                    </p>
                    <ul>
                        <li><strong>No Polls:</strong> Primary polls are expensive and rare for House races, especially in safe Democratic districts</li>
                        <li><strong>No Incumbent:</strong> With Jan Schakowsky retiring, there's no baseline approval rating or incumbency advantage to model</li>
                        <li><strong>Uncertain Turnout:</strong> Primary turnout models are harder to calibrate than general election models</li>
                    </ul>

                    <div class="methodology-note" style="background: rgba(0, 170, 220, 0.08); border-left: 3px solid rgba(0, 170, 220, 0.4); padding: 1rem 1.25rem; margin-top: 2rem;">
                        <strong>Status:</strong> The model is actively being developed. In the meantime, refer to the <a href="/markets" style="color: #00aadc; text-decoration: underline;">Markets page</a> for real-time prediction market aggregation, which reflects the collective wisdom of traders putting real money on the line.
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>

<script>
function toggleMethodology() {
    const content = document.getElementById('methodologyContent');
    const icon = document.getElementById('methodologyToggle');
    content.classList.toggle('hidden');
    icon.textContent = content.classList.contains('hidden') ? '▼' : '▲';
}
</script>

<style scoped>
.model-page-wrapper {
    position: relative;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

.horizontal-rows {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    z-index: 1;
    pointer-events: none;
}

.h-row {
    --blue-offset: 0%;
    --cyan-offset: 0%;
    --blue-opacity: 1;
    --cyan-opacity: 1;
    flex: 1;
    width: 100%;
    position: relative;
    overflow: hidden;
}

/* Blue light source - bottom right, fades toward top */
.h-row::before {
    content: '';
    position: absolute;
    bottom: calc(-25% + var(--blue-offset));
    right: calc(-30% + var(--blue-offset));
    width: 120%;
    height: 450%;
    background: radial-gradient(ellipse at center, rgba(0, 90, 255, 0.6) 0%, rgba(0, 60, 200, 0.35) 20%, rgba(0, 40, 150, 0.15) 40%, transparent 60%);
    filter: blur(45px);
    opacity: var(--blue-opacity);
    pointer-events: none;
}

/* Cyan light source - top left, fades toward bottom */
.h-row::after {
    content: '';
    position: absolute;
    top: calc(-20% + var(--cyan-offset));
    left: calc(-30% + var(--cyan-offset));
    width: 120%;
    height: 450%;
    background: radial-gradient(ellipse at center, rgba(0, 220, 255, 0.5) 0%, rgba(0, 180, 220, 0.3) 18%, rgba(0, 140, 180, 0.15) 35%, transparent 55%);
    filter: blur(40px);
    opacity: var(--cyan-opacity);
    pointer-events: none;
}

.inner-nav {
    position: relative;
    z-index: 10;
}

.model-content {
    position: relative;
    z-index: 10;
    max-width: 900px;
    margin: 0 auto;
    text-align: center;
    padding: 6rem 2rem;
}

.model-statement {
    font-size: 1.3rem;
    line-height: 1.8;
    color: var(--text-secondary);
    font-weight: 400;
    margin-top: 2rem;
}

.methodology-section {
    background: rgba(26, 26, 26, 0.5);
    border: 2px solid rgba(58, 58, 58, 0.6);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
}

.methodology-header {
    padding: 2rem;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: background 0.3s ease;
}

.methodology-header:hover {
    background: rgba(0, 170, 220, 0.1);
}

.toggle-icon {
    font-size: 1.5rem;
    color: #00aadc;
    transition: transform 0.3s ease;
}

.methodology-content {
    padding: 0 2rem 2rem;
    max-height: 2000px;
    overflow: hidden;
    transition: max-height 0.5s ease, padding 0.3s ease;
}

.methodology-content.hidden {
    max-height: 0;
    padding: 0 2rem;
}

.methodology-explanation {
    line-height: 1.8;
}

.methodology-explanation h3 {
    font-family: 'Cormorant Garamond', Georgia, serif;
    font-size: 1.5rem;
    margin: 2rem 0 1rem;
    color: #00aadc;
}

.methodology-explanation h3:first-child {
    margin-top: 0;
}

.methodology-explanation p {
    margin-bottom: 1rem;
    color: var(--text-secondary);
}

.methodology-explanation ul {
    list-style: none;
    padding-left: 0;
    margin: 1rem 0;
}

.methodology-explanation li {
    padding: 0.5rem 0 0.5rem 1.5rem;
    position: relative;
    color: var(--text-secondary);
}

.methodology-explanation li:before {
    content: "→";
    position: absolute;
    left: 0;
    color: #00aadc;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const navbar = document.querySelector('.navbar');
    const footer = document.querySelector('.footer');
    if (navbar) navbar.style.display = 'none';
    if (footer) footer.style.display = 'none';

    // Generate horizontal rows with offset gradients
    const container = document.getElementById('horizontalRows');
    const numRows = 12;

    for (let i = 0; i < numRows; i++) {
        const row = document.createElement('div');
        row.className = 'h-row';

        // Blue light (bottom-right): fades as you go UP, horizontal shift
        const blueOpacity = 0.15 + (i / (numRows - 1)) * 0.85;
        const blueOffsetH = (i - (numRows / 2)) * 4;

        // Cyan light (top-left): fades as you go DOWN, horizontal shift
        const cyanOpacity = 0.15 + (((numRows - 1) - i) / (numRows - 1)) * 0.85;
        const cyanOffsetH = ((numRows / 2) - i) * 4;

        row.style.setProperty('--blue-offset', `${blueOffsetH}%`);
        row.style.setProperty('--blue-opacity', blueOpacity);
        row.style.setProperty('--cyan-offset', `${cyanOffsetH}%`);
        row.style.setProperty('--cyan-opacity', cyanOpacity);
        container.appendChild(row);
    }
});
</script>
{% endblock %}
